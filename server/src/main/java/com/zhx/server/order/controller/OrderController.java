package com.zhx.server.order.controller;import com.zhx.hwtcommon.common.util.MD5Util;import com.zhx.server.order.service.OrderService;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Value;import org.springframework.stereotype.Controller;import org.springframework.util.StringUtils;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.servlet.ModelAndView;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.util.HashMap;import java.util.Map;/** * gaoxiang by 2018/11/5 15:55 */@Controller@RequestMapping("order")public class OrderController {    private Logger log = LoggerFactory.getLogger(OrderController.class);    @Autowired    private OrderService orderService;    @Value("${hwt.api.client_secret}")    private String client_secret;    @RequestMapping("orderDetail")    public ModelAndView orderDetail(String code, String oid, String sign, HttpServletRequest request) {        ModelAndView mav = new ModelAndView();        if(StringUtils.isEmpty(code) || StringUtils.isEmpty(oid) || StringUtils.isEmpty(sign)){            mav.addObject("error",new HashMap<String,String>(){{                put("msg","链接不合法");            }});            mav.setViewName("error");            return mav;        }        String mm= "{\"code\":\""+ code +"\",\"oid\":\""+ oid +"\"}" + client_secret;        String  sky = MD5Util.endcodeMd5(mm);        if(!sign.equals(sky)){            mav.addObject("error",new HashMap<String,String>(){{                put("msg","系统错误");            }});            mav.setViewName("error");            return mav;        }        System.out.println(code);        log.info("-------- code == {}", code);        Map map = orderService.orderDetail(code, oid);        if(map == null || !"000".equals(String.valueOf(map.get("code")))){            mav.addObject("error",map);            mav.setViewName("error");            return mav;        }        mav.addObject("cardInfo", map);        mav.setViewName("order/orderDetail");        return mav;    }    @RequestMapping("goodsInfo")    public ModelAndView goodsInfo(String goodsId) {        ModelAndView mav = new ModelAndView();        System.out.println(goodsId);        log.info("-------- goodsId == {}", goodsId);        Map map = orderService.goodsInfo(goodsId);        mav.addObject("goodsInfo", map);        mav.setViewName("goods/goodsInfo");        return mav;    }}